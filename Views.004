AK155 16.06.2006 <Views.pas> Views.004

             Частичное чтение данных из диалогов

   Введена возможность пометки элементов (точнее, их меток), после
чего GetData диалога читает данные только отмеченных элементов,
а для остальных память остаётся без изменений.

   Описываемый аппарат введён для того, чтобы в диалоге настроек
вида панели можно было задать изменение одного или нескольких
элементов во многоих целевых комплектах без изменения остальных
элементов. Регистрация отметки введена на уровне TView, для этого
служит новый бит состояния sfTagged.

   Новое поведение управляется переменными TaggedDataOnly и
TaggedDataCount и затрагивает объекты TLabel и TGroup (фактически
TDialog). Флаг TaggedDataOnly разрешает отметку элементов диалога
и одновременно включает режим чтения данных только отмеченных
элементов, см. TGroup.GetData. TaggedDataCount подсчитывает число
отмеченных элементов (без учёта групп, в которые они входят).
Если TaggedDataCount=0, то читаются данные всех элементов - если
человек ничего не отмечал, то вряд ли он хотел записать ничего,
скорее уж всё.

   Отметка первично выполняется в TLabel. Там предполагается, что
Link^.Owner^ является TGroup (обычно диалог) и этому Link^.Owner^
посылается команда cmTagData или cmUntagData, чтобы известить его
об отметке или разотметке элемента.
   Группе нужно знать о наличии в ней отмеченных элементов, чтобы
корректно сформировать собственную отметку. См. TaggedSubviewCount.
Если все первичные элементвы вставлены прямо в диалог, то эта
возня с отметкой группы не нужна. Но если книжке с закладками в
диалог вставлены страницы, которые суть группы, и там эта техника
нужна, чтобы опросить данные страниц, имеющих отмеченные элементы.

